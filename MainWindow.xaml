<!-- MainWindow.xaml -->
<Window x:Class="EnshroudedPlanner.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:helix="clr-namespace:HelixToolkit.Wpf;assembly=HelixToolkit.Wpf"
        Title="Enshrouded Planner" Height="900" Width="1500"
        x:Name="MainWindowControl"
        PreviewKeyDown="Window_PreviewKeyDown">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="320"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <!-- TOP BAR -->
        <Border Grid.Row="0" Grid.ColumnSpan="2" Padding="6" Margin="0,0,0,10"
                BorderBrush="#FFB0B0B0" BorderThickness="1" CornerRadius="6" Background="#FFF7F7F7">
            <DockPanel LastChildFill="True">
                <!-- Left: File actions -->
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Left">
                    <Button x:Name="BtnNewBlueprint" Content="🆕 Neu" Margin="2" Padding="10,4"/>
                    <Button x:Name="BtnSaveBlueprint" Content="💾 Blueprint Speichern" Margin="2" Padding="10,4"/>
                    <Button x:Name="BtnLoadBlueprint" Content="📂 Blueprint Laden" Margin="2" Padding="10,4"/>

                    <Separator Width="10" Opacity="0"/>

                    <Button x:Name="BtnExportBlueprint" Content="⤓ Snippet Export" Margin="2" Padding="10,4"/>
                    <Button x:Name="BtnImportBlueprint" Content="➕ Snippet Import" Margin="2" Padding="10,4"/>
                </StackPanel>

                <!-- Right: Updates + Settings -->
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button x:Name="BtnCheckUpdates" Content="⟳ Nach Updates suchen…" Margin="2" Padding="10,4"
                            ToolTip="Update-Check manuell starten"/>
                    <Button x:Name="BtnSettings" Content="⚙" Margin="2" Padding="10,4"
                            ToolTip="Einstellungen"/>
                </StackPanel>
                <!-- Center: Projekt-Kurzinfo -->
                <TextBlock x:Name="TxtProjectSummary"
                           Text=""
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           FontWeight="SemiBold"
TextTrimming="CharacterEllipsis"
                           ToolTipService.ShowDuration="60000"
                           Margin="10,0"/>

            </DockPanel>
        </Border>

        <!-- LINKS: Auswahl -->
        <DockPanel Grid.Row="1" Grid.Column="0" Margin="0,0,10,0">

            <!-- TOP: Aktionen / Layer / Undo / Blueprint -->
            <Border DockPanel.Dock="Top" BorderBrush="#33000000" BorderThickness="1" CornerRadius="6" Padding="8" Margin="0,0,0,8">
                <StackPanel>
                    <TextBlock FontWeight="SemiBold" Text="Undo / Redo (max 20)" Margin="0,10,0,0"/>
                    <UniformGrid Columns="2" Margin="0,6,0,0">
                        <Button x:Name="BtnUndo" Content="⟲ Undo" Margin="2"/>
                        <Button x:Name="BtnRedo" Content="⟳ Redo" Margin="2"/>
                    </UniformGrid>

                    <Separator Margin="0,10,0,10"/>

                    <TextBlock FontWeight="SemiBold" Text="Layer (Platzier-Ebene)"/>
                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <Button x:Name="BtnLayerDown" Content="◀" Width="32" Margin="2"/>
                        <TextBox x:Name="TxtLayer" Width="60" TextAlignment="Center" VerticalContentAlignment="Center" Margin="2"/>
                        <Button x:Name="BtnLayerUp" Content="▶" Width="32" Margin="2"/>
                        <TextBlock x:Name="TxtLayerInfo" VerticalAlignment="Center" Margin="8,0,0,0"/>
                    </StackPanel>

                    <Slider x:Name="SliderLayer" Minimum="0" Maximum="79" Value="40"
                            TickFrequency="1" IsSnapToTickEnabled="True" Margin="0,6,0,0"/>

                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                        <Button x:Name="BtnLayerMinus8" Content="-8 Vox" Margin="2"/>
                        <Button x:Name="BtnLayerPlus8" Content="+8 Vox" Margin="2"/>
                    </StackPanel>

                    <Separator Margin="0,10,0,10"/>

                    <CheckBox x:Name="CheckShowGrid" Content="Grid anzeigen" IsChecked="True" FontWeight="SemiBold"/>
                    <CheckBox x:Name="CheckShowCompass" Content="Kompass anzeigen" IsChecked="True" FontWeight="SemiBold" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- BOTTOM: Projektinfo -->
            <Border DockPanel.Dock="Bottom" BorderBrush="#33000000" BorderThickness="1" CornerRadius="6" Padding="8" Margin="0,8,0,0">
                <Expander Header="Projekt-Details" IsExpanded="False">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" MaxHeight="180">
                        <TextBlock x:Name="ProjectInfo" TextWrapping="Wrap" Margin="0,6,0,0"/>
                    </ScrollViewer>
                </Expander>
            </Border>

            <!-- MIDDLE: Material + Element-Auswahl (separat scrollbar) -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
                <StackPanel>
                    <!-- Material / Voxel-Pinsel -->
                    <TextBlock FontSize="18" FontWeight="Bold" Text="Material / Voxel-Pinsel" />

                    <TextBlock FontWeight="SemiBold" Text="Kategorie" Margin="0,6,0,0"/>
                    <ComboBox x:Name="ComboMaterialGroup" Margin="0,6,0,0"/>

                    <TextBlock FontWeight="SemiBold" Text="Material (Tile)" Margin="0,10,0,0"/>

                    <Border BorderBrush="#33000000" BorderThickness="1" CornerRadius="6" Padding="6" Margin="0,6,0,0">
                        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled" Height="120">
                            <WrapPanel x:Name="MaterialTilesPanel" Orientation="Horizontal"/>
                        </ScrollViewer>
                    </Border>

                    <TextBlock x:Name="TxtActiveMaterial" Margin="0,8,0,0" TextWrapping="Wrap" Opacity="0.85"/>
                    <TextBlock Margin="0,6,0,0" TextWrapping="Wrap" Opacity="0.75"
                               Text="Links-Klick (ohne Piece): 1 Voxel setzen | Entfernen: Button 'Entfernen' + Linksklick"/>

                    <!-- Element-Auswahl -->
                    <Separator Margin="0,10,0,10"/>

                    <TextBlock FontSize="18" FontWeight="Bold" Text="Element-Auswahl" />

                    <UniformGrid Columns="3" Margin="0,8,0,0">
                        <ToggleButton x:Name="BtnWalls" Content="Wand/Boden" Margin="2" IsChecked="True"/>
                        <ToggleButton x:Name="BtnRoofs" Content="Dach" Margin="2"/>
                        <ToggleButton x:Name="BtnTerrain" Content="Terrain" Margin="2"/>
                    </UniformGrid>

                    <ToggleButton x:Name="BtnRemoveMode" Content="Entfernen" Margin="2" />

                    <TextBlock Margin="0,10,0,0" FontWeight="SemiBold" Text="Kategorie"/>
                    <ComboBox x:Name="CategoryCombo" Margin="0,4,0,0" />

                    <TextBlock Margin="0,10,0,0" FontWeight="SemiBold" Text="Piece"/>
                    <ListBox x:Name="PieceList" Height="220" Margin="0,4,0,0"/>
                </StackPanel>
            </ScrollViewer>
        </DockPanel>

        <!-- RECHTS: 4 Viewports -->
        <Grid Grid.Row="1" Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Viewport A -->
            <Border x:Name="Border0" Grid.Row="0" Grid.Column="0" Margin="4" BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0" Margin="6">
                        <TextBlock x:Name="Title0" Text="Viewport A" FontWeight="Bold" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <Button x:Name="BtnMax0" Content="⤢" Width="34" Height="26" DockPanel.Dock="Right" Margin="6,0,0,0"
                                Click="BtnMax_Click" Tag="0"/>
                        <ComboBox x:Name="ComboView0" Width="170" DockPanel.Dock="Right" Margin="6,0,0,0"
                                  SelectionChanged="ComboView_SelectionChanged" Tag="0">
                            <ComboBoxItem Content="Top" IsSelected="True"/>
                            <ComboBoxItem Content="Bottom"/>
                            <ComboBoxItem Content="Front"/>
                            <ComboBoxItem Content="Back"/>
                            <ComboBoxItem Content="Left"/>
                            <ComboBoxItem Content="Right"/>
                        </ComboBox>
                    </DockPanel>

                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="6">
                            <TextBlock x:Name="LblA0" Text="X: E" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderA0" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,10,0"/>
                            <TextBlock x:Name="LblB0" Text="Y: N" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderB0" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,0,0"/>
                        </StackPanel>

                        <helix:HelixViewport3D x:Name="View0" Grid.Row="1" Background="#FFF0F0F0"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Viewport B -->
            <Border x:Name="Border1" Grid.Row="0" Grid.Column="1" Margin="4" BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0" Margin="6">
                        <TextBlock x:Name="Title1" Text="Viewport B" FontWeight="Bold" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <Button x:Name="BtnMax1" Content="⤢" Width="34" Height="26" DockPanel.Dock="Right" Margin="6,0,0,0"
                                Click="BtnMax_Click" Tag="1"/>
                        <ComboBox x:Name="ComboView1" Width="170" DockPanel.Dock="Right" Margin="6,0,0,0"
                                  SelectionChanged="ComboView_SelectionChanged" Tag="1">
                            <ComboBoxItem Content="Front" IsSelected="True"/>
                            <ComboBoxItem Content="Back"/>
                            <ComboBoxItem Content="Top"/>
                            <ComboBoxItem Content="Bottom"/>
                            <ComboBoxItem Content="Left"/>
                            <ComboBoxItem Content="Right"/>
                        </ComboBox>
                    </DockPanel>

                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="6">
                            <TextBlock x:Name="LblA1" Text="X: E" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderA1" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,10,0"/>
                            <TextBlock x:Name="LblB1" Text="Z: U" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderB1" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,0,0"/>
                        </StackPanel>

                        <helix:HelixViewport3D x:Name="View1" Grid.Row="1" Background="#FFF0F0F0"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Viewport C -->
            <Border x:Name="Border2" Grid.Row="1" Grid.Column="0" Margin="4" BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0" Margin="6">
                        <TextBlock x:Name="Title2" Text="Viewport C" FontWeight="Bold" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <Button x:Name="BtnMax2" Content="⤢" Width="34" Height="26" DockPanel.Dock="Right" Margin="6,0,0,0"
                                Click="BtnMax_Click" Tag="2"/>
                        <ComboBox x:Name="ComboView2" Width="170" DockPanel.Dock="Right" Margin="6,0,0,0"
                                  SelectionChanged="ComboView_SelectionChanged" Tag="2">
                            <ComboBoxItem Content="Left" IsSelected="True"/>
                            <ComboBoxItem Content="Right"/>
                            <ComboBoxItem Content="Top"/>
                            <ComboBoxItem Content="Bottom"/>
                            <ComboBoxItem Content="Front"/>
                            <ComboBoxItem Content="Back"/>
                        </ComboBox>
                    </DockPanel>

                    <Grid Grid.Row="1">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="6">
                            <TextBlock x:Name="LblA2" Text="Y: N" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderA2" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,10,0"/>
                            <TextBlock x:Name="LblB2" Text="Z: U" VerticalAlignment="Center"/>
                            <Slider x:Name="SliderB2" Width="180" Minimum="-40" Maximum="40" Value="0" Margin="6,0,0,0"/>
                        </StackPanel>

                        <helix:HelixViewport3D x:Name="View2" Grid.Row="1" Background="#FFF0F0F0"/>
                    </Grid>
                </Grid>
            </Border>

            <!-- Viewport D (3D frei) -->
            <Border x:Name="Border3" Grid.Row="1" Grid.Column="1" Margin="4" BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel Grid.Row="0" Margin="6">
                        <TextBlock x:Name="Title3" Text="Viewport D (3D frei)" FontWeight="Bold" DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <Button x:Name="BtnMax3" Content="⤢" Width="34" Height="26" DockPanel.Dock="Right" Margin="6,0,0,0"
                                Click="BtnMax_Click" Tag="3"/>
                        <TextBlock Text="(fix)" DockPanel.Dock="Right" VerticalAlignment="Center" Margin="6,0,0,0"/>
                    </DockPanel>

                    <helix:HelixViewport3D x:Name="View3" Grid.Row="1" Background="#FFF0F0F0"/>
                </Grid>
            </Border>
        </Grid>
        <!-- STATUS -->
        <StatusBar Grid.Row="2" Grid.ColumnSpan="2" Margin="0,8,0,0">
            <StatusBarItem>
                <TextBlock x:Name="StatusTextBlock" Text="Bereit" />
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="StatusFileTextBlock" Text="(kein Blueprint)" />
            </StatusBarItem>
        </StatusBar>

    </Grid>
</Window>
